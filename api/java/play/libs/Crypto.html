<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<title>Crypto (Play 2.4-SNAPSHOT)</title>
<link rel="stylesheet" type="text/css" href="../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="Crypto (Play 2.4-SNAPSHOT)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../play/libs/Comet.html" title="class in play.libs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../play/libs/EventSource.html" title="class in play.libs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?play/libs/Crypto.html" target="_top">Frames</a></li>
<li><a href="Crypto.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">play.libs</div>
<h2 title="Class Crypto" class="title">Class Crypto</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>play.libs.Crypto</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">Crypto</span>
extends java.lang.Object</pre>
<div class="block">Cryptographic utilities.
 <br>
 These utilities are intended as a convenience, however it is important to read each methods documentation and
 understand the concepts behind encryption to use this class properly.  Safe encryption is hard, and there is no
 substitute for an adequate understanding of cryptography.  These methods will not be suitable for all encryption
 needs.

 For more information about cryptography, we recommend reading the OWASP Cryptographic Storage Cheatsheet:

 https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../play/libs/Crypto.html#Crypto()">Crypto</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#compareSignedTokens(java.lang.String, java.lang.String)">compareSignedTokens</a></strong>(java.lang.String&nbsp;tokenA,
                   java.lang.String&nbsp;tokenB)</code>
<div class="block">Compare two signed tokens</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#constantTimeEquals(java.lang.String, java.lang.String)">constantTimeEquals</a></strong>(java.lang.String&nbsp;a,
                  java.lang.String&nbsp;b)</code>
<div class="block">Constant time equals method.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#decryptAES(java.lang.String)">decryptAES</a></strong>(java.lang.String&nbsp;value)</code>
<div class="block">Decrypt a String with the AES encryption standard using the application's secret key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#decryptAES(java.lang.String, java.lang.String)">decryptAES</a></strong>(java.lang.String&nbsp;value,
          java.lang.String&nbsp;privateKey)</code>
<div class="block">Decrypt a String with the AES encryption standard.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#encryptAES(java.lang.String)">encryptAES</a></strong>(java.lang.String&nbsp;value)</code>
<div class="block">Encrypt a String with the AES encryption standard using the application's secret key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#encryptAES(java.lang.String, java.lang.String)">encryptAES</a></strong>(java.lang.String&nbsp;value,
          java.lang.String&nbsp;privateKey)</code>
<div class="block">Encrypt a String with the AES encryption standard and the supplied private key.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#extractSignedToken(java.lang.String)">extractSignedToken</a></strong>(java.lang.String&nbsp;token)</code>
<div class="block">Extract a signed token that was signed by <a href="../../play/libs/Crypto.html#signToken(java.lang.String)"><code>signToken(String)</code></a>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#generateSignedToken()">generateSignedToken</a></strong>()</code>
<div class="block">Generate a signed token</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#generateToken()">generateToken</a></strong>()</code>
<div class="block">Generate a cryptographically secure token</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#sign(java.lang.String)">sign</a></strong>(java.lang.String&nbsp;message)</code>
<div class="block">Signs the given String with HMAC-SHA1 using the application's secret key.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#sign(java.lang.String, byte[])">sign</a></strong>(java.lang.String&nbsp;message,
    byte[]&nbsp;key)</code>
<div class="block">Signs the given String with HMAC-SHA1 using the given key.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../play/libs/Crypto.html#signToken(java.lang.String)">signToken</a></strong>(java.lang.String&nbsp;token)</code>
<div class="block">Sign a token.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="Crypto()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>Crypto</h4>
<pre>public&nbsp;Crypto()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="sign(java.lang.String, byte[])">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sign</h4>
<pre>public static&nbsp;java.lang.String&nbsp;sign(java.lang.String&nbsp;message,
                    byte[]&nbsp;key)</pre>
<div class="block">Signs the given String with HMAC-SHA1 using the given key.
 <br>
 By default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - The message to sign.</dd><dd><code>key</code> - The private key to sign with.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A hexadecimal encoded signature.</dd></dl>
</li>
</ul>
<a name="sign(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sign</h4>
<pre>public static&nbsp;java.lang.String&nbsp;sign(java.lang.String&nbsp;message)</pre>
<div class="block">Signs the given String with HMAC-SHA1 using the application's secret key.
 <br>
 By default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>message</code> - The message to sign.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A hexadecimal encoded signature.</dd></dl>
</li>
</ul>
<a name="signToken(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>signToken</h4>
<pre>public static&nbsp;java.lang.String&nbsp;signToken(java.lang.String&nbsp;token)</pre>
<div class="block">Sign a token.  This produces a new token, that has this token signed with a nonce.

 This primarily exists to defeat the BREACH vulnerability, as it allows the token to effectively be random per
 request, without actually changing the value.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>token</code> - The token to sign</dd>
<dt><span class="strong">Returns:</span></dt><dd>The signed token</dd></dl>
</li>
</ul>
<a name="extractSignedToken(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>extractSignedToken</h4>
<pre>public static&nbsp;java.lang.String&nbsp;extractSignedToken(java.lang.String&nbsp;token)</pre>
<div class="block">Extract a signed token that was signed by <a href="../../play/libs/Crypto.html#signToken(java.lang.String)"><code>signToken(String)</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>token</code> - The signed token to extract.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The verified raw token, or null if the token isn't valid.</dd></dl>
</li>
</ul>
<a name="generateToken()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateToken</h4>
<pre>public static&nbsp;java.lang.String&nbsp;generateToken()</pre>
<div class="block">Generate a cryptographically secure token</div>
</li>
</ul>
<a name="generateSignedToken()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateSignedToken</h4>
<pre>public static&nbsp;java.lang.String&nbsp;generateSignedToken()</pre>
<div class="block">Generate a signed token</div>
</li>
</ul>
<a name="compareSignedTokens(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>compareSignedTokens</h4>
<pre>public static&nbsp;boolean&nbsp;compareSignedTokens(java.lang.String&nbsp;tokenA,
                          java.lang.String&nbsp;tokenB)</pre>
<div class="block">Compare two signed tokens</div>
</li>
</ul>
<a name="constantTimeEquals(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>constantTimeEquals</h4>
<pre>public static&nbsp;boolean&nbsp;constantTimeEquals(java.lang.String&nbsp;a,
                         java.lang.String&nbsp;b)</pre>
<div class="block">Constant time equals method.

 Given a length that both Strings are equal to, this method will always run in constant time.  This prevents
 timing attacks.</div>
</li>
</ul>
<a name="encryptAES(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptAES</h4>
<pre>public static&nbsp;java.lang.String&nbsp;encryptAES(java.lang.String&nbsp;value)</pre>
<div class="block">Encrypt a String with the AES encryption standard using the application's secret key.
 <br>
 The provider used is by default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.
 <br>
 The transformation algorithm used is the provider specific implementation of the <code>AES</code> name.  On
 Oracles JDK, this is <code>AES/ECB/PKCS5Padding</code>.  This algorithm is suitable for small amounts of data,
 typically less than 32 bytes, hence is useful for encrypting credit card numbers, passwords etc.  For larger
 blocks of data, this algorithm may expose patterns and be vulnerable to repeat attacks.
 <br>
 The transformation algorithm can be configured by defining <code>application.crypto.aes.transformation</code> in
 <code>application.conf</code>.  Although any cipher transformation algorithm can be selected here, the secret key
 spec used is always AES, so only AES transformation algorithms will work.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - The String to encrypt.</dd>
<dt><span class="strong">Returns:</span></dt><dd>An hexadecimal encrypted string.</dd></dl>
</li>
</ul>
<a name="encryptAES(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encryptAES</h4>
<pre>public static&nbsp;java.lang.String&nbsp;encryptAES(java.lang.String&nbsp;value,
                          java.lang.String&nbsp;privateKey)</pre>
<div class="block">Encrypt a String with the AES encryption standard and the supplied private key.
 <br>
 The private key must have a length of 16 bytes.
 <br>
 The provider used is by default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.
 <br>
 The transformation algorithm used is the provider specific implementation of the <code>AES</code> name.  On
 Oracles JDK, this is <code>AES/ECB/PKCS5Padding</code>.  This algorithm is suitable for small amounts of data,
 typically less than 32bytes, hence is useful for encrypting credit card numbers, passwords etc.  For larger
 blocks of data, this algorithm may expose patterns and be vulnerable to repeat attacks.
 <br>
 The transformation algorithm can be configured by defining <code>application.crypto.aes.transformation</code> in
 <code>application.conf</code>.  Although any cipher transformation algorithm can be selected here, the secret key
 spec used is always AES, so only AES transformation algorithms will work.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - The String to encrypt.</dd><dd><code>privateKey</code> - The key used to encrypt.</dd>
<dt><span class="strong">Returns:</span></dt><dd>An hexadecimal encrypted string.</dd></dl>
</li>
</ul>
<a name="decryptAES(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>decryptAES</h4>
<pre>public static&nbsp;java.lang.String&nbsp;decryptAES(java.lang.String&nbsp;value)</pre>
<div class="block">Decrypt a String with the AES encryption standard using the application's secret key.
 <br>
 The provider used is by default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.
 <br>
 The transformation used is by default <code>AES/ECB/PKCS5Padding</code>.  It can be configured by defining
 <code>application.crypto.aes.transformation</code> in <code>application.conf</code>.  Although any cipher
 transformation algorithm can be selected here, the secret key spec used is always AES, so only AES transformation
 algorithms will work.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - An hexadecimal encrypted string.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The decrypted String.</dd></dl>
</li>
</ul>
<a name="decryptAES(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>decryptAES</h4>
<pre>public static&nbsp;java.lang.String&nbsp;decryptAES(java.lang.String&nbsp;value,
                          java.lang.String&nbsp;privateKey)</pre>
<div class="block">Decrypt a String with the AES encryption standard.
 <br>
 The private key must have a length of 16 bytes.
 <br>
 The provider used is by default this uses the platform default JSSE provider.  This can be overridden by defining
 <code>application.crypto.provider</code> in <code>application.conf</code>.
 <br>
 The transformation used is by default <code>AES/ECB/PKCS5Padding</code>.  It can be configured by defining
 <code>application.crypto.aes.transformation</code> in <code>application.conf</code>.  Although any cipher
 transformation algorithm can be selected here, the secret key spec used is always AES, so only AES transformation
 algorithms will work.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>value</code> - An hexadecimal encrypted string.</dd><dd><code>privateKey</code> - The key used to encrypt.</dd>
<dt><span class="strong">Returns:</span></dt><dd>The decrypted String.</dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../index-all.html">Index</a></li>
<li><a href="../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../play/libs/Comet.html" title="class in play.libs"><span class="strong">Prev Class</span></a></li>
<li><a href="../../play/libs/EventSource.html" title="class in play.libs"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../index.html?play/libs/Crypto.html" target="_top">Frames</a></li>
<li><a href="Crypto.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
